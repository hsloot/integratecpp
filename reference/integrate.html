<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Adaptive quadrature of functions of one variable over a finite or
  infinite interval."><title>A method for numerical integration — integrate • integratecpp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A method for numerical integration — integrate"><meta property="og:description" content="Adaptive quadrature of functions of one variable over a finite or
  infinite interval."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">integratecpp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../html/index.html">C++ Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/comparison.html">Comparing numerical integration packages</a>
    <a class="dropdown-item" href="../articles/integratecpp-usage.html">Using `integratecpp`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A method for numerical integration</h1>
      
      <div class="d-none name"><code>integrate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adaptive quadrature of functions of one variable over a finite or
  infinite interval.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integrate</span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  <span class="va">lower</span>,</span>
<span>  <span class="va">upper</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  max_subdivisions <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  relative_accuracy <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.25</span>,</span>
<span>  absolute_accuracy <span class="op">=</span> <span class="va">relative_accuracy</span>,</span>
<span>  work_size <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">max_subdivisions</span>,</span>
<span>  stop.on.error <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Based on QUADPACK routines <code>dqags</code> and <code>dqagi</code> by
  R. Piessens and E. deDoncker--Kapenga, available from Netlib.</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>f</dt>
<dd><p>an <span style="R">R</span> function taking a numeric first argument and returning
    a numeric vector of the same length.  Returning a non-finite element will
    generate an error.</p></dd>


<dt>lower, upper</dt>
<dd><p>the limits of integration.  Can be infinite.</p></dd>


<dt>...</dt>
<dd><p>additional arguments to be passed to <code>f</code>.</p></dd>


<dt>max_subdivisions</dt>
<dd><p>the maximum number of subintervals.</p></dd>


<dt>relative_accuracy</dt>
<dd><p>relative accuracy requested.</p></dd>


<dt>absolute_accuracy</dt>
<dd><p>absolute accuracy requested.</p></dd>


<dt>stop.on.error</dt>
<dd><p>logical. If true (the default) an error stops the
    function.  If false some errors will give a result with a warning in
    the <code>message</code> component.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of class <code>"integrate"</code> with components</p>
<dl><dt>value</dt>
<dd><p>the final estimate of the integral.</p></dd>

  <dt>abs.error</dt>
<dd><p>estimate of the modulus of the absolute error.</p></dd>

  <dt>subdivisions</dt>
<dd><p>the number of subintervals produced in the
    subdivision process.</p></dd>

  <dt>message</dt>
<dd><p><code>"OK"</code> or a character string giving the error message.</p></dd>

  <dt>call</dt>
<dd><p>the matched call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that arguments after <code>...</code> must be matched exactly.</p>
<p>If one or both limits are infinite, the infinite range is mapped onto
  a finite interval.</p>
<p>For a finite interval, globally adaptive interval subdivision is used
  in connection with extrapolation by Wynn's Epsilon algorithm, with the
  basic step being Gauss--Kronrod quadrature.</p>
<p><code>rel.tol</code> cannot be less than <code>max(50*.Machine$double.eps,
    0.5e-28)</code> if <code>abs.tol &lt;= 0</code>.</p>
<p>Note that the comments in the C source code in
  <code class="file">&lt;R&gt;/src/appl/integrate.c</code> give more details, particularly about
  reasons for failure (internal error code <code>ier &gt;= 1</code>).</p>
<p>In <span style="R">R</span> versions \(\le\) 3.2.x, the first entries of
  <code>lower</code> and <code>upper</code> were used whereas an error is signalled
  now if they are not of length one.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Like all numerical integration routines, these evaluate the function
  on a finite set of points.  If the function is approximately constant
  (in particular, zero) over nearly all its range it is possible that
  the result and error estimate may be seriously wrong.</p>
<p>When integrating over infinite intervals do so explicitly, rather than
  just using a large number as the endpoint.  This increases the chance
  of a correct answer -- any function whose integral over an infinite
  interval is finite must be near zero for most of that interval.</p>
<p>For values at a finite set of points to be a fair reflection of the
  behaviour of the function elsewhere, the function needs to be
  well-behaved, for example differentiable except perhaps for a small
  number of jumps or integrable singularities.</p>
<p><code>f</code> must accept a vector of inputs and produce a vector of function
  evaluations at those points.  The <code><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></code> function
  may be helpful to convert <code>f</code> to this form.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. Piessens, E. deDoncker--Kapenga, C. Uberhuber, D. Kahaner (1983)
  <em>Quadpack: a Subroutine Package for Automatic Integration</em>;
  Springer Verlag.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="op">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9500042 with absolute error &lt; 1e-11</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 with absolute error &lt; 9.4e-05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## a slowly-convergent integral</span></span></span>
<span class="r-in"><span><span class="va">integrand</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">integrand</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.141593 with absolute error &lt; 2.7e-05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## don't do this if you really want the integral from 0 to Inf</span></span></span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">integrand</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.529038 with absolute error &lt; 3e-04</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">integrand</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.135268 with absolute error &lt; 4.2e-07</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">integrand</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1000000</span>, stop.on.error <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> failed with message ‘the integral is probably divergent’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## some functions do not handle vector input properly</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">2.0</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">integrate</span><span class="op">(</span><span class="va">f</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in integrate(f, 0, 1) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   evaluation of function gave a result of wrong length</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co">## correct</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 with absolute error &lt; 2.2e-14</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2.0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co">## correct</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 with absolute error &lt; 2.2e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## integrate can fail if misused</span></span></span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4772499 with absolute error &lt; 5.3e-15</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 with absolute error &lt; 3.7e-05</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 with absolute error &lt; 1.6e-07</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 with absolute error &lt; 4.4e-06</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="fl">20000</span><span class="op">)</span> <span class="co">## fails on many systems</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 with absolute error &lt; 0</span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span>   <span class="co">## works</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 with absolute error &lt; 4.7e-05</span>
<span class="r-in"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/assertCondition.html" class="external-link">assertError</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu">integrate</span><span class="op">(</span><span class="va">dnorm</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span> <span class="co">#-&gt; error!</span></span></span>
<span class="r-in"><span><span class="co">## "silently" gave  integrate(dnorm, 0, 20)  in earlier versions of R</span></span></span>
<span class="r-in"><span> , verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Asserted error: length(lower) == 1 is not TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Henrik Sloot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

