<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides a header-only C++11 interface to R's C-API for
    numerical integration.">
<title>C++ API for R Integration Routines • integratecpp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="C++ API for R Integration Routines">
<meta property="og:description" content="Provides a header-only C++11 interface to R's C-API for
    numerical integration.">
<meta property="og:image" content="https://hsloot.github.io/integratecpp/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">integratecpp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/integratecpp.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reference">Reference</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reference">
    <a class="dropdown-item" href="reference/index.html">R Reference</a>
    <a class="dropdown-item" href="sphinx/index.html">C++ Reference</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/web_only/comparison.html">Comparing numerical integration packages</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hsloot/integratecpp/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="integratecpp">integratecpp<a class="anchor" aria-label="anchor" href="#integratecpp"></a>
</h1>
</div>
<!-- badges: start -->
<!-- markdownlint-capture -->
<!-- markdownlint-disable MD045 -->

<p>The package <code>integratecpp</code> provides a header-only C++11 interface to R’s C-API for numerical integration.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>integratecpp</code> like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hsloot/integratecpp"</span><span class="op">)</span></span></code></pre></div>
<p>To include the header into your C++ source files for building with Rcpp, use</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// C++</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::plugins(cpp11)]]</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::depends(integratecpp)]]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;integratecpp.h&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">// your code</span></span></code></pre></div>
<p>To use the header in source files of an R-package, include the following lines in your <code>DESCRIPTION</code> file:</p>
<pre class="deb-control"><code><span><span class="va">LinkingTo</span><span class="op">:</span> <span class="va">integratecpp</span></span></code></pre>
<p>Note that the header includes only <code>C++</code> standard library headers and <a href="https://github.com/wch/r-source/blob/trunk/src/include/R_ext/Applic.h" class="external-link"><code>&lt;R_ext/Applic.h&gt;</code></a>.</p>
</div>
<div class="section level2">
<h2 id="how-to-use-it">How to use it?<a class="anchor" aria-label="anchor" href="#how-to-use-it"></a>
</h2>
<p>Suppose you want to integrate the identity function over the unit interval. First, you include the required headers (and Rcpp attributes, if Rcpp is used), for example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;integratecpp.h&gt;</span></span></code></pre></div>
<p>Second, you have to define the integrand as a <code>Callable</code> that is invocable by <code>const double</code> and returns <code>double</code>, for example a lambda-functor:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> fn <span class="op">=</span> <span class="op">[](</span><span class="at">const</span> <span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>Third, you can use the integrate routine:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> result <span class="op">=</span> integratecpp<span class="op">::</span>integrate<span class="op">(</span>fn<span class="op">,</span> <span class="fl">0.</span><span class="op">,</span> <span class="fl">1.</span><span class="op">);</span></span></code></pre></div>
<p>Better, the last part should be enclosed in a try-catch block:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> result <span class="op">=</span> integratecpp<span class="op">::</span>integrate<span class="op">(</span>fn<span class="op">,</span> <span class="fl">0.</span><span class="op">,</span> <span class="fl">1.</span><span class="op">);</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="at">const</span> integratecpp<span class="op">::</span>integration_logic_error <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="at">const</span> integratecpp<span class="op">::</span>integration_runtime_error <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Optional configurations similar to those of <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">stats::integrate</a></code> are also available if needed. For a more realistic example, see <a href="https://hsloot.github.io/integratecpp/articles/integratecpp.html">“Using <code>integratecpp</code>”</a>.</p>
</div>
<div class="section level2">
<h2 id="why-is-this-useful">Why is this useful?<a class="anchor" aria-label="anchor" href="#why-is-this-useful"></a>
</h2>
<p>Many R package authors implement critical parts, including numeric integration, in C, Fortran or C++ to improve performance. However, while R provides an <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#The-R-API" class="external-link">API for C</a> and it is possible to <a href="https://isocpp.org/wiki/faq/mixing-c-and-cpp" class="external-link">mix C and C++</a>, using the C-API in C++ code can pose a higher burden for those more familiar with R and Rcpp than C++ or C.</p>
<p>Using the C-API for the numerical integration routines requires adhering to the interface of the functions <code>Rdqags</code> or <code>Rdqagi</code>. This can be done by creating a callback functor taking a <code>void *</code> pointer to the original function, which is then internally cast to the correct type and is used to overwrite an array of doubles with corresponding function evaluations. This is rather complicated and requires being more familiarity with pointers. Additionally, it requires translating error codes into a proper error message. To make it worse, not guarding callback functions against C++ exceptions introduces possible undefined behavior.</p>
<p>This packages bridges this gap by providing a simple, easy-to-use C++11 wrapper for R’s C-API for numerical integration.</p>
</div>
<div class="section level2">
<h2 id="alternatives">Alternatives<a class="anchor" aria-label="anchor" href="#alternatives"></a>
</h2>
<p>There are alternatives to using <code>integratecpp</code> or R’s C-API for numerical integration in compiled code of R packages. Two examples are:</p>
<ul>
<li>Linking to the <a href="https://www.gnu.org/software/gsl/" class="external-link">GNU scientific library</a>, possibly using <a href="https://github.com/eddelbuettel/rcppgsl" class="external-link">RcppGSL</a>.</li>
<li>Using <a href="https://github.com/yixuan/RcppNumerical" class="external-link">RcppNumerical</a>, which provides a similar approach to ours.</li>
</ul>
<p>Both approaches provide a finer control over the specific integration algorithms than R does. The following table provides a summary.</p>
<!-- markdownlint-capture -->
<!-- markdownlint-disable MD013 -->
<table class="table">
<colgroup>
<col width="12%">
<col width="9%">
<col width="9%">
<col width="12%">
<col width="18%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left"><strong>Approach</strong></th>
<th><strong>Depends</strong></th>
<th><strong>Imports</strong></th>
<th><strong>LinkingTo</strong></th>
<th><strong>SystemRequirements</strong></th>
<th><strong>External dependency</strong></th>
<th><strong>Additional features</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>integratecpp</code></td>
<td><code>R &gt;= 3.1</code></td>
<td>(Rcpp<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The current version of &lt;code&gt;integratecpp&lt;/code&gt; imports and links to Rcpp for internal testing. This dependency might be removed in future versions and can be avoided if the header is vendored into the project.&lt;/p&gt;"><sup>1</sup></a>)</td>
<td>(Rcpp)</td>
<td>C++11</td>
<td></td>
<td>❌</td>
</tr>
<tr class="even">
<td align="left">C-API</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>❌</td>
</tr>
<tr class="odd">
<td align="left">gsl</td>
<td></td>
<td>(Rcpp)</td>
<td>(Rcpp, RcppGSL)</td>
<td></td>
<td>gsl</td>
<td>✅</td>
</tr>
<tr class="even">
<td align="left">RcppNumerical</td>
<td></td>
<td>Rcpp</td>
<td>Rcpp, RcppEigen</td>
<td></td>
<td></td>
<td>✅</td>
</tr>
</tbody>
</table>
<!--markdownlint-restore --><p>What separates our approach are little additional dependencies (zero, if vendored) and an intuitive pure-C++ API which does not rely on Rcpp itself. Hence, as <code>Rdqags</code> and <code>Rdqagi</code> are not using longjumps <em>themselves</em>, our approach can be used in a pure C++ back-end.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note that the provided integrator-function itself should not use longjumps (e.g., R functions provided through Rcpp) to exit the frame; if you want to use R functions with &lt;code&gt;Rcpp &amp;gt;= 1.0.10&lt;/code&gt;, consider defining &lt;code&gt;RCPP_NO_UNWIND_PROTECT&lt;/code&gt; before loading the Rcpp header file.&lt;/p&gt;"><sup>2</sup></a> A comparison of different numerical integration approaches in C++ is summarized in the article <a href="https://hsloot.github.io/integratecpp/articles/web_only/comparison.html">“Comparing numerical integration packages”</a>.</p>
</div>
<div class="section level2">
<h2 id="outlook">Outlook<a class="anchor" aria-label="anchor" href="#outlook"></a>
</h2>
<p>The current version of <code>integratecpp</code> has the following shortcomings which could be addressed in future versions:</p>
<ul>
<li>We currently import and link to Rcpp to generate test functions which are not exported. Future versions might remove this dependency, see <a href="https://github.com/hsloot/integratecpp/issues/8" class="external-link">#8</a>.</li>
<li>R’s C-API for numerical integration allows reusing workspace variables. We have not implemented this feature, i.e., each call to <code>integratecpp::integrate(...)</code> or <code>integratecpp::integrator::operator()(...)</code> will create a <code>std::vector&lt;int&gt;</code> and a <code>std::vector&lt;double&gt;</code> of length <code>limit</code> and <code>4 * limit</code>, respectively. Future versions might make workspace variables class members of the <code>integratecpp::integrator</code> or allow to provide them externally, see <a href="https://github.com/hsloot/integratecpp/issues/9" class="external-link">#9</a>.</li>
<li>The current version of <code>integratecpp</code> is licensed under <code>GPL (&gt;=3)</code> due to its dependence and linking to Rcpp, the header-only library is licensed under <code>LGPL (&gt;=3)</code> as it only depends only on STL headers and <a href="https://github.com/wch/r-source/blob/trunk/src/include/R_ext/Applic.h" class="external-link"><code>&lt;R_ext/Applic.h&gt;</code></a>. The latter is licensed under <code>LGPL (&gt;= 2.1)</code> (see <a href="https://github.com/wch/r-source/blob/trunk/doc/COPYRIGHTS" class="external-link"><code>doc/COPYRIGHTS</code></a>). Hence, future versions might relicense the package under a more permissive library if the Rcpp dependency can be removed, see <a href="https://github.com/hsloot/integratecpp/issues/10" class="external-link">#10</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>integratecpp</code> project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>


  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hsloot/integratecpp/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing integratecpp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Henrik Sloot <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8582-7776" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/hsloot/integratecpp?branch=main" class="external-link"><img src="https://codecov.io/gh/hsloot/integratecpp/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://hsloot.github.io/integratecpp/"><img src="https://img.shields.io/badge/pkgdown-integratecpp-blue.svg"></a></li>
<li><a href="https://hsloot.github.io/integratecpp/html/index.html"><img src="https://img.shields.io/badge/Doxygen-integratecpp-blue.svg"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Henrik Sloot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
